"""=====================================================================================================================
# codon.py
#
# Michael Gribskov 1/28/2026
====================================================================================================================="""


class Codon:
    """-----------------------------------------------------------------------------------------------------------------
    Codon

    codon2aa - class variable with standard codon definitions stored as dict
    -----------------------------------------------------------------------------------------------------------------"""
    codon2aa = {"AAA": "K", "AAC": "N", "AAG": "K", "AAT": "N",
                "ACA": "T", "ACC": "T", "ACG": "T", "ACT": "T",
                "AGA": "R", "AGC": "S", "AGG": "R", "AGT": "S",
                "ATA": "I", "ATC": "I", "ATG": "M", "ATT": "I",

                "CAA": "Q", "CAC": "H", "CAG": "Q", "CAT": "H",
                "CCA": "P", "CCC": "P", "CCG": "P", "CCT": "P",
                "CGA": "R", "CGC": "R", "CGG": "R", "CGT": "R",
                "CTA": "L", "CTC": "L", "CTG": "L", "CTT": "L",

                "GAA": "E", "GAC": "D", "GAG": "E", "GAT": "D",
                "GCA": "A", "GCC": "A", "GCG": "A", "GCT": "A",
                "GGA": "G", "GGC": "G", "GGG": "G", "GGT": "G",
                "GTA": "V", "GTC": "V", "GTG": "V", "GTT": "V",

                "TAA": "*", "TAC": "Y", "TAG": "*", "TAT": "T",
                "TCA": "S", "TCC": "S", "TCG": "S", "TCT": "S",
                "TGA": "*", "TGC": "C", "TGG": "W", "TGT": "C",
                "TTA": "L", "TTC": "F", "TTG": "L", "TTT": "F"}

    def __init__(self):
        """-------------------------------------------------------------------------------------------------------------
        Constructor for Codon class
        -------------------------------------------------------------------------------------------------------------"""
        self.count = {c: 0 for c in Codon.codon2aa}

    def add_from_dna(self, dna, frame=0):
        """-------------------------------------------------------------------------------------------------------------
        Add the codon counts from a DNA sequence in fasta format to the current count

        :param dna: Fasta   fasta formatted DNA sequence
        :param frame: int   reading frame to use, 0 indicates start with base 0
        :return: int        number of codons added
        -------------------------------------------------------------------------------------------------------------"""


# ######################################################################################################################
# Testing
# ######################################################################################################################
if __name__ == '__main__':
    coding = Codon()
    print(id(coding.codon2aa))

    exit(0)
